#!/bin/bash

FLEXGET_VERSION=$(docker inspect --format '{{ index .Config.Labels "org.label-schema.version"}}' $IMAGE_NAME)
FLEXGET_SHORT_VERSION=${FLEXGET_VERSION%.*}
FLEXGET_MAJOR_VERSION=${FLEXGET_SHORT_VERSION%.*}

docker tag $IMAGE_NAME $DOCKER_REPO:$FLEXGET_VERSION
docker push $DOCKER_REPO:$FLEXGET_VERSION

docker tag $IMAGE_NAME $DOCKER_REPO:$FLEXGET_SHORT_VERSION
docker push $DOCKER_REPO:$FLEXGET_SHORT_VERSION

docker tag $IMAGE_NAME $DOCKER_REPO:$FLEXGET_MAJOR_VERSION
docker push $DOCKER_REPO:$FLEXGET_MAJOR_VERSION
